---
title: "echarts"
format: html
---


```{r}
dados <- pokemon::pokemon_ptbr |> tibble::as_tibble()
dados
```


```{r}
custom_tooltip <- function(e, trigger = c("item", "axis"), ...) 
{
    if (missing(e)) {
        stop("must pass e", call. = FALSE)
    }
    tooltip <- list(trigger = trigger[1], ...)
    if (!e$x$tl) {
        e$x$opts$tooltip <- tooltip
    }
    else {
        e$x$opts$baseOption$tooltip <- tooltip
    }
    e
}
```

```{r}
dados |>
  dplyr::filter(
    id_geracao %in% 1:4
  ) |>
  dplyr::mutate(
    ataque_final = (ataque + ataque_especial) / 2,
    defesa_final = (defesa + defesa_especial) / 2
  ) |>
  echarts4r::e_chart(x = defesa_final) |>
  echarts4r::e_scatter(
    serie = ataque_final,
    markLine = list(
      data = list(
        list(
          list(coord = c(0, 0), symbol = "none"),
          list(coord = c(150, 150), symbol = "none")
        )
      )
    )
  ) |>
  echarts4r::e_color(color = "white") |>
  custom_tooltip(
    formatter = htmlwidgets::JS(
      "function(params) {
        let text = '<b>Defesa</b>: ' + params.value[0];
        text += '<br>';
        text += '<b>Ataque</b>: ' + params.value[1];
        text += '<br><br>';
        text += '<img src =\"https://raw.githubusercontent.com/HybridShivam/Pokemon/master/assets/images/001.png\" width = 50px style = \"display: block; margin: auto;\">';
        return text;
      }
    ")
  )
```


```{r}
opcoes <- list(
  xAxis = list(
    type = "value"
  ),
  yAxis = list(
    type = "value"
  ),
  series = list(
    list(
      symbolSize = 20,
      type = "scatter",
      data = list(
        list(10, 8.04),
        list(20, 2.04)
      )
    )
  )
)

echarts4r::e_charts() |> 
  echarts4r::e_list(opcoes)
```